@{
    ViewData["Title"] = "Inicio";
    var isAuthenticated = User?.Identity?.IsAuthenticated == true;
}

<div class="text-center">
    <h1 class="display-4">SIGECES UTEC</h1>
    <p class="lead">Sistema de gestión de cursos extracurriculares para estudiantes UTEC.</p>
</div>

<hr />

@if (!isAuthenticated)
{
    <div class="alert alert-info">
        Para acceder a los cursos, inicia sesión con tu usuario de SIGECES.
    </div>

    <p>
        <a asp-controller="Account" asp-action="Login" class="btn btn-primary">
            Iniciar sesión
        </a>
    </p>
}
else if (User.IsInRole("Admin"))
{
    <h3>Panel de administración</h3>
    <p class="text-muted">Resumen rápido del estado de la plataforma.</p>

    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Usuarios</h5>
                    <p class="display-6">@ViewBag.TotalUsers</p>
                    <p class="mb-0"><small>Estudiantes activos: @ViewBag.TotalStudents</small></p>
                    <p class="mb-0"><small>Instructores activos: @ViewBag.TotalInstructors</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Cursos</h5>
                    <p class="display-6">@ViewBag.TotalCourses</p>
                    <p class="mb-0"><small>Activos: @ViewBag.ActiveCourses</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Inscripciones</h5>
                    <p class="display-6">@ViewBag.TotalEnrollments</p>
                    <p class="mb-0"><small>Completadas: @ViewBag.CompletedEnrollments</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">% Finalización global</h5>
                    <p class="display-6">@ViewBag.GlobalCompletionPercent%</p>
                </div>
            </div>
        </div>
    </div>

    <h4>Accesos rápidos</h4>
    <div class="list-group mb-3">
        <a asp-controller="Courses" asp-action="Index" class="list-group-item list-group-item-action">
            Gestionar cursos
        </a>
        <a asp-controller="CourseCategories" asp-action="Index" class="list-group-item list-group-item-action">
            Categorías de cursos
        </a>
        <a asp-controller="Users" asp-action="Index" class="list-group-item list-group-item-action">
            Usuarios
        </a>
        <a asp-controller="AdminReports" asp-action="Index" class="list-group-item list-group-item-action">
            Reportes y exportaciones (CSV)
        </a>
    </div>
}
else if (User.IsInRole("Instructor"))
{
    <h2 class="mb-4">Panel del Instructor</h2>
    <p class="text-muted">Resumen de tus cursos y el avance de tus estudiantes.</p>

    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Mis cursos</h5>
                    <p class="display-6">@ViewBag.MyCoursesCount</p>
                    <p class="mb-0"><small>Total creados</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Cursos activos</h5>
                    <p class="display-6">@ViewBag.MyActiveCourses</p>
                    <p class="mb-0"><small>Visibles para estudiantes</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Inscripciones</h5>
                    <p class="display-6">@ViewBag.MyTotalEnrollments</p>
                    <p class="mb-0"><small>En todos tus cursos</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">% Finalización global</h5>
                    <p class="display-6">@ViewBag.MyCompletionPercent%</p>
                    <p class="mb-0"><small>Completados / inscritos</small></p>
                </div>
            </div>
        </div>
    </div>

    <h4>Acciones rápidas</h4>
    <div class="list-group mb-3">
        <a asp-controller="Courses" asp-action="Index" class="list-group-item list-group-item-action">
            Ver / editar mis cursos
        </a>
        <a asp-controller="InstructorReports" asp-action="Index" class="list-group-item list-group-item-action">
            Reportes de mis cursos (CSV y KPIs)
        </a>
    </div>
}
else if (User.IsInRole("Student"))
{
    <h3>Panel de estudiante</h3>
    <p class="text-muted">Resumen de tu avance en los cursos extracurriculares.</p>

    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Cursos inscritos</h5>
                    <p class="display-6">@ViewBag.MyTotalEnrollments_Student</p>
                    <p class="mb-0"><small>Total de inscripciones</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">En progreso</h5>
                    <p class="display-6">@ViewBag.MyInProgressEnrollments_Student</p>
                    <p class="mb-0"><small>Cursos activos</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Completados</h5>
                    <p class="display-6">@ViewBag.MyCompletedEnrollments_Student</p>
                    <p class="mb-0"><small>Cursos finalizados</small></p>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Avance en lecciones</h5>
                    <p class="display-6">@ViewBag.MyLessonsCompletionPercent_Student%</p>
                    <p class="mb-0">
                        <small>
                            @ViewBag.MyCompletedLessons_Student / @ViewBag.MyTotalLessons_Student lecciones
                        </small>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <h4>Acciones rápidas</h4>
    <div class="row">
        <div class="col-md-6 mb-3">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Catálogo de cursos</h5>
                    <p class="card-text">
                        Ver todos los cursos disponibles en SIGECES.
                    </p>
                    <a asp-controller="StudentCourses" asp-action="Index" class="btn btn-primary">
                        Ir al catálogo
                    </a>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-3">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Mis cursos</h5>
                    <p class="card-text">
                        Revisa tus inscripciones activas y cursos en progreso.
                    </p>
                    <a asp-controller="StudentCourses" asp-action="MyCourses" class="btn btn-outline-primary">
                        Ver mis cursos
                    </a>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <p>No se pudo determinar tu rol. Contacta al administrador.</p>
}
